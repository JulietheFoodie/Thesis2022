---
title: "Loop Data Upload"
author: "Julie Norman"
date: '2022-06-20'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Libraries

```{r}
library("tidyverse")
```

## States

### Alabama

```{r}

al_files <- list.files("Data Sets/Alabama Data Source/Alabama xlsx/")

for(i in 1:length(al_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("al1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Alabama Data Source/Alabama xlsx/",
                   al_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Arkansas

```{r}

ak_files <- list.files("Data Sets/Arkansas Data Source/Arkansas xlsx/")

for(i in 1:length(ak_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("ak1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Arkansas Data Source/Arkansas xlsx/",
                   ak_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Florida 

```{r}

fl_files <- list.files("Data Sets/Florida Data Source/Florida xlsx/")

for(i in 1:length(fl_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("fl1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Florida Data Source/Florida xlsx/",
                   fl_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}


```

### Georgia

```{r}

ga_files <- list.files("Data Sets/Georgia Data Source/Georgia xlsx/")

for(i in 1:length(ga_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("ga1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Georgia Data Source/Georgia xlsx/",
                   ga_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Illinois

```{r}

il_files <- list.files("Data Sets/Illinois Data Source/Illinois xlsx/")

for(i in 1:length(il_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("il1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Illinois Data Source/Illinois xlsx/",
                   il_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Indiana

```{r}

in_files <- list.files("Data Sets/Indiana Data Source/Indiana xlsx/")

for(i in 1:length(in_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("in1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Indiana Data Source/Indiana xlsx/",
                   in_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Iowa

```{r}

ia_files <- list.files("Data Sets/Iowa Data Source/Iowa xlsx/")

for(i in 1:length(ia_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("ia1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Iowa Data Source/Iowa xlsx/",
                   ia_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Kansas

```{r}

ks_files <- list.files("Data Sets/Kansas Data Source/Kansas xlsx/")

for(i in 1:length(ks_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("ks1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Kansas Data Source/Kansas xlsx/",
                   ks_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Kentucky

```{r}

ky_files <- list.files("Data Sets/Kentucky Data Source/Kentucky xlsx/")

for(i in 1:length(ky_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("ky1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Kentucky Data Source/Kentucky xlsx/",
                   ky_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Louisiana 

```{r}

la_files <- list.files("Data Sets/Louisiana Data Source/Louisiana xlsx/")

for(i in 1:length(la_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("la1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Louisiana Data Source/Louisiana xlsx/",
                   la_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Minnesota

```{r}

mn_files <- list.files("Data Sets/Minnesota Data Source/Minnesota xlsx/")

for(i in 1:length(mn_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("mn1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Minnesota Data Source/Minnesota xlsx/",
                   mn_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Mississippi

```{r}

ms_files <- list.files("Data Sets/Mississippi Data Source/Mississippi xlsx/")

for(i in 1:length(ms_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("ms1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Mississippi Data Source/Mississippi xlsx/",
                   ms_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Missouri cleaned

```{r}

mo_files <- list.files("Data Sets/Missouri Data Source/Missouri xlsx/")

for(i in 1:length(mo_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("mo1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Missouri Data Source/Missouri xlsx/",
                   mo_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Montana

```{r}

mt_files <- list.files("Data Sets/Montana Data Source/Montana xlsx/")

for(i in 1:length(mt_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("mt1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Montana Data Source/Montana xlsx/",
                   mt_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Nebraska

```{r}

ne_files <- list.files("Data Sets/Nebraska Data Source/Nebraska xlsx/")

for(i in 1:length(ne_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("ne1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Nebraska Data Source/Nebraska xlsx/",
                   ne_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### North Carolina

```{r}
# Data upload 

nc_files <- list.files("Data Sets/North Carolina Data Source/North Carolina xlsx/")

for(i in 1:length(nc_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("nc1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/North Carolina Data Source/North Carolina xlsx/",
                   nc_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### North Dakota

```{r}
# Data upload 

nd_files <- list.files("Data Sets/North Dakota Data Source/North Dakota xlsx/")

for(i in 1:length(nd_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("nd1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/North Dakota Data Source/North Dakota xlsx/",
                   nd_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### South Carolina

```{r}
# Data upload 

sc_files <- list.files("Data Sets/South Carolina Data Source/South Carolina xlsx/")

for(i in 1:length(sc_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("sc1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/South Carolina Data Source/South Carolina xlsx/",
                   sc_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### South Dakota

```{r}
# Data upload 

sd_files <- list.files("Data Sets/South Dakota Data Source/South Dakota xlsx/")

for(i in 1:length(sc_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("sd1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/South Dakota Data Source/South Dakota xlsx/",
                   sd_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Tennessee

```{r}
# Data upload 

tn_files <- list.files("Data Sets/Tennessee Data Source/Tennessee xlsx/")

for(i in 1:length(tn_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("tn1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Tennessee Data Source/Tennessee xlsx/",
                   tn_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Virginia

```{r}

va_files <- list.files("Data Sets/Virginia Data Source/Virginia xlsx/")

for(i in 1:length(va_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("va1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Virginia Data Source/Virginia xlsx/",
                   va_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### West Virginia

```{r}
# Data upload 

wv_files <- list.files("Data Sets/West Virginia Data Source/West Virginia xlsx/")

for(i in 1:length(wv_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("wv1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/West Virginia Data Source/West Virginia xlsx/",
                   wv_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Wisconsin

```{r}
# Data upload 

wi_files <- list.files("Data Sets/Wisconsin Data Source/Wisconsin xlsx/")

for(i in 1:length(wi_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("wi1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Wisconsin Data Source/Wisconsin xlsx/",
                   wi_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```

### Wyoming

```{r}
# Data upload 

wy_files <- list.files("Data Sets/Wyoming Data Source/Wyoming xlsx/")

for(i in 1:length(wy_files)) { 
  for (j in 2:5) {
    
  # Head of for-loop
  assign(paste0("wy1", i, "_df", LETTERS[j]),                                   
  # Read and store data frames
         read.xlsx(paste0("Data Sets/Wyoming Data Source/Wyoming xlsx/",
                   wy_files[i]), 
                   sheet = (j),
                   fillMergedCells = TRUE, 
                   colNames = FALSE))
    
  }
}

```




## Combine by Year

```{r}
state <- c("al", "ak", "fl", "ga", "il", "in", "ia", "ks", "ky", "la", "mn", "ms", "mo", "mt", "ne", "nc", "nd", "sc", "sd", "tn", "va", "wv", "wi", "wy")
```


### 2011

```{r}

datalist11 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "11df_list"),
       list(get(paste0(i, "11_dfB")), 
            get(paste0(i, "11_dfC")), 
            get(paste0(i, "11_dfD")), 
            get(paste0(i, "11_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "11D_df"),
       (get(paste0(i, "11df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "11D_df2"), get(paste0(i, "11D_df")) %>%
         slice(-2) %>%
         select(-which(duplicated(as.list(get(paste0(i, "11D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "11D_newnames"), paste(
             slice(get(paste0(i, "11D_df2")), 1),
             slice(get(paste0(i, "11D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "11D_df3"), get(paste0(i, "11D_df2")) %>%
         slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "11_df"), 
       setnames(get(paste0(i, "11D_df3")), 
                colnames(get(paste0(i, "11D_df2"))), 
                get(paste0(i, "11D_newnames"))))

# Add Year
Year <- 2011
assign(paste0(i, "11_df"), cbind(get(paste0(i, "11_df")), Year))


# List of Datasets
datalist11[[i]] <- get(paste0(i, "11_df"))


}

# Combine Datasets
all_df11 <- do.call(rbind, datalist11)


```

### 2012

```{r}

datalist12 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "12df_list"),
       list(get(paste0(i, "12_dfB")), 
            get(paste0(i, "12_dfC")), 
            get(paste0(i, "12_dfD")), 
            get(paste0(i, "12_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "12D_df"),
       (get(paste0(i, "12df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "12D_df2"), get(paste0(i, "12D_df")) %>%
         slice(-2) %>%
         select(-which(duplicated(as.list(get(paste0(i, "12D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "12D_newnames"), paste(
             slice(get(paste0(i, "12D_df2")), 1),
             slice(get(paste0(i, "12D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "12D_df3"), get(paste0(i, "12D_df2")) %>%
         slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "12_df"), 
       setnames(get(paste0(i, "12D_df3")), 
                colnames(get(paste0(i, "12D_df2"))), 
                get(paste0(i, "12D_newnames"))))

# Add Year
Year <- 2012
assign(paste0(i, "12_df"), cbind(get(paste0(i, "12_df")), Year))


# List of Datasets
datalist12[[i]] <- get(paste0(i, "12_df"))


}

# Combine Datasets
all_df12 <- do.call(rbind, datalist12)

```

### 2013 *Need to delete cell in files

```{r}

datalist13 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "13df_list"),
       list(get(paste0(i, "13_dfB")), 
            get(paste0(i, "13_dfC")), 
            get(paste0(i, "13_dfD")), 
            get(paste0(i, "13_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "13D_df"),
       (get(paste0(i, "13df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "13D_df2"), get(paste0(i, "13D_df")) %>%
         select(-which(duplicated(as.list(get(paste0(i, "13D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "13D_newnames"), paste(
             slice(get(paste0(i, "13D_df2")), 1),
             slice(get(paste0(i, "13D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "13D_df3"), get(paste0(i, "13D_df2")) %>%
         slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "13_df"), 
       setnames(get(paste0(i, "13D_df3")), 
                colnames(get(paste0(i, "13D_df2"))), 
                get(paste0(i, "13D_newnames"))))

# Add Year
Year <- 2013
assign(paste0(i, "13_df"), cbind(get(paste0(i, "13_df")), Year))


# List of Datasets
datalist13[[i]] <- get(paste0(i, "13_df"))


}

# Combine Datasets
all_df13 <- do.call(bind_rows, datalist13)

```

```{r}
state <- c("al", "ak", "fl", "ga", "il", "in", "ia", "ks", "ky", "la", "mn", "ms", "mo", "mt", "ne", "nc", "nd", "sc", "sd", "tn", "va", "wv", "wi", "wy")

state <- c("al", "ak", "fl", "ga", "il", "in", "ia", "ks", "ky", "la", "mn", "ms", "mo", "mt", "ne", "nc", "nd", "sc", "sd", "tn", "va", "wv", "wi", "wy")

setdiff(colnames(al17_df), colnames(mo17_df))
```


### 2014 *need to delete cell in files

```{r}

datalist14 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "14df_list"),
       list(get(paste0(i, "14_dfB")), 
            get(paste0(i, "14_dfC")), 
            get(paste0(i, "14_dfD")), 
            get(paste0(i, "14_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "14D_df"),
       (get(paste0(i, "14df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "14D_df2"), get(paste0(i, "14D_df")) %>%
         select(-which(duplicated(as.list(get(paste0(i, "14D_df"))))))
         )

# merge first two rows for new column names


 assign(paste0(i, "14D_newnames"), paste(
             slice(get(paste0(i, "14D_df2")), 1),
             slice(get(paste0(i, "14D_df2")), 3),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "14D_df3"), get(paste0(i, "14D_df2")) %>%
         slice(-c(1, 2, 3))) 
 
# add new column names
assign(paste0(i, "14_df"), 
       setnames(get(paste0(i, "14D_df3")), 
                colnames(get(paste0(i, "14D_df2"))), 
                get(paste0(i, "14D_newnames"))))

# Add Year
Year <- 2014
assign(paste0(i, "14_df"), cbind(get(paste0(i, "14_df")), Year))


# List of Datasets
datalist14[[i]] <- get(paste0(i, "14_df"))


}

# Combine Datasets
all_df14 <- do.call(rbind, datalist14)

setdiff(colnames(al14_df), colnames(ak14_df))
```

### 2015

```{r}

datalist15 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "15df_list"),
       list(get(paste0(i, "15_dfB")), 
            get(paste0(i, "15_dfC")), 
            get(paste0(i, "15_dfD")), 
            get(paste0(i, "15_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "15D_df"),
       (get(paste0(i, "15df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "15D_df2"), get(paste0(i, "15D_df")) %>%
         slice(-c(2, 3, 4)) %>%
         select(-which(duplicated(as.list(get(paste0(i, "15D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "15D_newnames"), paste(
             slice(get(paste0(i, "15D_df2")), 1),
             slice(get(paste0(i, "15D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "15D_df3"), get(paste0(i, "15D_df2")) %>%
         slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "15_df"), 
       setnames(get(paste0(i, "15D_df3")), 
                colnames(get(paste0(i, "15D_df2"))), 
                get(paste0(i, "15D_newnames"))))

# Add Year
Year <- 2015
assign(paste0(i, "15_df"), cbind(get(paste0(i, "15_df")), Year))


# List of Datasets
datalist15[[i]] <- get(paste0(i, "15_df"))


}

# Combine Datasets
all_df15 <- do.call(rbind, datalist15)

```


### 2016

```{r}

datalist16 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "16df_list"),
       list(get(paste0(i, "16_dfB")), 
            get(paste0(i, "16_dfC")), 
            get(paste0(i, "16_dfD")), 
            get(paste0(i, "16_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "16D_df"),
       (get(paste0(i, "16df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "16D_df2"), get(paste0(i, "16D_df")) %>%
         slice(-c(2, 3, 4)) %>%
         select(-which(duplicated(as.list(get(paste0(i, "16D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "16D_newnames"), paste(
             slice(get(paste0(i, "16D_df2")), 1),
             slice(get(paste0(i, "16D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "16D_df3"), get(paste0(i, "16D_df2")) %>%
         slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "16_df"), 
       setnames(get(paste0(i, "16D_df3")), 
                colnames(get(paste0(i, "16D_df2"))), 
                get(paste0(i, "16D_newnames"))))

# Add Year
Year <- 2016
assign(paste0(i, "16_df"), cbind(get(paste0(i, "16_df")), Year))

# List of Datasets
datalist16[[i]] <- get(paste0(i, "16_df"))


}

# Combine Datasets
all_df16 <- do.call(bind_rows, datalist16)

```

### 2017

```{r}

datalist17 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "17df_list"),
       list(get(paste0(i, "17_dfB")), 
            get(paste0(i, "17_dfC")), 
            get(paste0(i, "17_dfD")), 
            get(paste0(i, "17_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "17D_df"),
       (get(paste0(i, "17df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "17D_df2"), get(paste0(i, "17D_df")) %>%
         select(-which(duplicated(as.list(get(paste0(i, "17D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "17D_newnames"), paste(
             slice(get(paste0(i, "17D_df2")), 1),
             slice(get(paste0(i, "17D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "17D_df3"), get(paste0(i, "17D_df2")) %>%
         slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "17_df"), 
       setnames(get(paste0(i, "17D_df3")), 
                colnames(get(paste0(i, "17D_df2"))), 
                get(paste0(i, "17D_newnames"))))

# Add Year
Year <- 2017
assign(paste0(i, "17_df"), cbind(get(paste0(i, "17_df")), Year))

# List of Datasets
datalist17[[i]] <- get(paste0(i, "17_df"))


}

# Combine Datasets
all_df17 <- do.call(bind_rows, datalist17)

# Drop redundent columns
all_df17 <- subset(all_df17, select = -c(NA.County...20, NA.County...3))

```

### 2018

```{r}

datalist18 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "18df_list"),
       list(get(paste0(i, "18_dfB")), 
            get(paste0(i, "18_dfC")), 
            get(paste0(i, "18_dfD")), 
            get(paste0(i, "18_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "18D_df"),
       (get(paste0(i, "18df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "18D_df2"), get(paste0(i, "18D_df")) %>%
         select(-which(duplicated(as.list(get(paste0(i, "18D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "18D_newnames"), paste(
             slice(get(paste0(i, "18D_df2")), 1),
             slice(get(paste0(i, "18D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "18D_df3"), get(paste0(i, "18D_df2")) %>%
         slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "18_df"), 
       setnames(get(paste0(i, "18D_df3")), 
                colnames(get(paste0(i, "18D_df2"))), 
                get(paste0(i, "18D_newnames"))))

# Add Year
Year <- 2018
assign(paste0(i, "18_df"), cbind(get(paste0(i, "18_df")), Year))

# List of Datasets
datalist18[[i]] <- get(paste0(i, "18_df"))


}

# Combine Datasets
all_df18 <- do.call(rbind, datalist18)

```

### 2019

```{r}

datalist19 = list()

for(i in state){

# put all data frames into list
assign(paste0(i, "19df_list"),
       list(get(paste0(i, "19_dfB")), 
            get(paste0(i, "19_dfC")), 
            get(paste0(i, "19_dfD")), 
            get(paste0(i, "19_dfE"))))
    
# merge all data frames in list
assign(paste0(i, "19D_df"),
       (get(paste0(i, "19df_list")) %>% 
          reduce(full_join, by = 'X1')
        ))

# Delete Duplicate Columns and row (unsure where row came from)
assign(paste0(i, "19D_df2"), get(paste0(i, "19D_df")) %>%
         select(-which(duplicated(as.list(get(paste0(i, "19D_df"))))))
         )

# merge first two rows for new column names
 assign(paste0(i, "19D_newnames"), paste(
             slice(get(paste0(i, "19D_df2")), 1),
             slice(get(paste0(i, "19D_df2")), 2),
             sep = '.'))
 
 # delete old column rows
assign(paste0(i, "19D_df3"), get(paste0(i, "19D_df2")) %>%
        slice(-c(1, 2))) 
 
# add new column names
assign(paste0(i, "19_df"), 
       setnames(get(paste0(i, "19D_df3")), 
                colnames(get(paste0(i, "19D_df2"))), 
                get(paste0(i, "19D_newnames"))))

# Add Year
Year <- 2019
assign(paste0(i, "19_df"), cbind(get(paste0(i, "19_df")), Year))

# List of Datasets
datalist19[[i]] <- get(paste0(i, "19_df"))


}

# Combine Datasets
all_df19 <- do.call(rbind, datalist19)

```

## Combine all data years

```{r}
datalist <- list()

for(i in 1:9){
  
  datalist[[i]] <- get(paste0("all_df1", i))
  
}
```



17, 14, 13
